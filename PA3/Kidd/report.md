# CST 3-2-2 Kidd

张益铭  车13  2021010552

## 算法思路和实现要点

- 思路

  - 本代码实现了一种基于线段树的数据结构，用于处理将指定区间的卡牌全部翻转，以及计算指定区间内被翻转的总次数。

  - 为了降低时间和空间复杂度，参考PA思路提示，我实现了如下优化：

    - 离散化处理：通过排序和去重，将输入区间映射到离散值域，减小线段树所需的节点数。

    - 懒惰标记：使用 `lazy` 数组记录未传播的翻转操作，减少不必要的更新。

- 要点

  - 通过对输入的所有端点进行排序和去重，生成一个离散化的区间数组 `Interval`。然后将原始区间的端点通过映射定位到 `Interval` 的索引，用于在线段树中操作。

  - 使用递归构建线段树，每个节点维护其对应的值域 `[l, r)` 和累积的翻转次数 `count`。

  - 在更新或查询区间时，将未处理的标记延迟应用到子节点，避免多余的重复计算。

## 渐进时间复杂度的分析，包含过程

1. 建树

   构建线段树的复杂度为O(n)，n是离散化后的区间个数，因为每个节点仅被访问一次。

2. 翻转和查询

   每次翻转或查询操作的复杂度为O(logn)，因为线段树的高度为O(logn)，操作过程中最多访问一个从根到叶节点的路径。

3. 区间离散化

   离散化过程需要对2m+2个端点进行排序，复杂度为O(mlogm)，m是输入的区间个数。

因此总复杂度为O(mlog⁡m)+O(n)+O(qlog⁡n)，q 为翻转和查询操作的总次数。

## 渐进空间复杂度的分析，包含过程

线段树占用的空间主要节点数组 `nodes`，懒惰标记 `lazy`以及离散化数组 `Interval`

总体渐进空间复杂度为O(n+m)


## 遇到的困难和解决方法

遇到的主要困难是空间不足，提交了许多次都显示`Runtime error`，最后发现可以通过区间离散化来减少线段树节点个数

## 估计完成本题所用时间 
10小时

## 关于本题的更多感想

无
